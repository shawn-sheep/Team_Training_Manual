## The 2020 ICPC Asia Yinchuan Regional Programming Contest

https://codeforces.com/gym/104022

## D题 Farm

一道不错的最小生成树题目

最小生成树最麻烦的点在于不确定性，不知道哪条边可以选入，所以对边有限制的时候一般不能直接跑Kruscal，而要跑个带限制的Kruscal

这道题最关键的是把可选边的数目降到O(q)的级别，再通过最后暴搜要取哪条边确定最小方案（这就是最小生成树不确定带来的后果）。
降到O(q)级别就相当于划分成O(q)级别个连通块，就相当于把每个限制边上两端点都属于不同连通块，每个限制点都是一个独立的连通块，这些就是肯定要拿的边。将限制边放在最前面跑一遍最小生成树
此时边的数目还是很大，还需要将剩下的边筛选一下。我们观察剩下的边的作用就是将这O(q)个连通块相连，所以我们将这O(q)个连通块视为一个个点，相当于去除限制边再跑个最小生成树就好了，这些边就是可选边，数量为O(q)
还有个注意的点是：路经压缩的并查集不能撤回，需要按秩合并，所以这道题两个并查集可以用路经压缩，但是最后爆搜的并查集用按秩合并即可。

最后总结一下这道题的代码顺序：
1. 将限制边放在最前面，再按边长短排序，跑一遍最小生成树，维护三个并查集
2. 将第一遍剩余的可能边跑一遍最小生成树，维护两个并查集，形成可选边集合
3. 最后暴力枚举限制边，每次对可选边集合跑最小生成树，得到ans

做图论题还是得一步步来保持思路清晰，难度其实不是很大
